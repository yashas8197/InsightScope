const { initializeDatabase } = require("./db/db.connect");
require("dotenv").config();
const Data = require("./models/data.model");
const express = require("express");
const cors = require("cors");
const { default: mongoose } = require("mongoose");
const app = express();

app.use(express.json());

const corsOptions = {
  origin: "*",
  credentials: true,
  optionSuccessStatus: 200,
};

app.use(cors(corsOptions));
initializeDatabase();

const seedItems = [
  {
    day: "4/10/2022",
    age: "15-25",
    gender: "Male",
    A: 678,
    B: 829,
    C: 564,
    D: 975,
    E: 114,
    F: 997,
  },
  {
    day: "4/10/2022",
    age: ">25",
    gender: "Male",
    A: 20,
    B: 786,
    C: 419,
    D: 882,
    E: 225,
    F: 673,
  },
  {
    day: "4/10/2022",
    age: "15-25",
    gender: "Female",
    A: 137,
    B: 652,
    C: 6,
    D: 339,
    E: 391,
    F: 768,
  },
  {
    day: "4/10/2022",
    age: ">25",
    gender: "Female",
    A: 183,
    B: 216,
    C: 639,
    D: 424,
    E: 953,
    F: 95,
  },
  {
    day: "5/10/2022",
    age: "15-25",
    gender: "Male",
    A: 115,
    B: 236,
    C: 51,
    D: 64,
    E: 688,
    F: 652,
  },
  {
    day: "5/10/2022",
    age: ">25",
    gender: "Male",
    A: 909,
    B: 748,
    C: 530,
    D: 228,
    E: 2,
    F: 839,
  },
  {
    day: "5/10/2022",
    age: "15-25",
    gender: "Female",
    A: 855,
    B: 608,
    C: 178,
    D: 254,
    E: 357,
    F: 881,
  },
  {
    day: "5/10/2022",
    age: ">25",
    gender: "Female",
    A: 525,
    B: 930,
    C: 317,
    D: 146,
    E: 981,
    F: 993,
  },
  {
    day: "6/10/2022",
    age: "15-25",
    gender: "Male",
    A: 12,
    B: 791,
    C: 942,
    D: 660,
    E: 773,
    F: 57,
  },
  {
    day: "6/10/2022",
    age: ">25",
    gender: "Male",
    A: 272,
    B: 786,
    C: 531,
    D: 308,
    E: 582,
    F: 961,
  },
  {
    day: "6/10/2022",
    age: "15-25",
    gender: "Female",
    A: 680,
    B: 741,
    C: 898,
    D: 852,
    E: 24,
    F: 521,
  },
  {
    day: "6/10/2022",
    age: ">25",
    gender: "Female",
    A: 878,
    B: 554,
    C: 455,
    D: 160,
    E: 388,
    F: 454,
  },
  {
    day: "7/10/2022",
    age: "15-25",
    gender: "Male",
    A: 616,
    B: 454,
    C: 790,
    D: 815,
    E: 457,
    F: 631,
  },
  {
    day: "7/10/2022",
    age: ">25",
    gender: "Male",
    A: 525,
    B: 990,
    C: 732,
    D: 526,
    E: 931,
    F: 669,
  },
  {
    day: "7/10/2022",
    age: "15-25",
    gender: "Female",
    A: 939,
    B: 811,
    C: 30,
    D: 701,
    E: 783,
    F: 128,
  },
  {
    day: "7/10/2022",
    age: ">25",
    gender: "Female",
    A: 732,
    B: 160,
    C: 342,
    D: 626,
    E: 658,
    F: 626,
  },
  {
    day: "8/10/2022",
    age: "15-25",
    gender: "Male",
    A: 643,
    B: 22,
    C: 781,
    D: 426,
    E: 858,
    F: 113,
  },
  {
    day: "8/10/2022",
    age: ">25",
    gender: "Male",
    A: 746,
    B: 264,
    C: 111,
    D: 119,
    E: 622,
    F: 584,
  },
  {
    day: "8/10/2022",
    age: "15-25",
    gender: "Female",
    A: 650,
    B: 760,
    C: 868,
    D: 413,
    E: 473,
    F: 66,
  },
  {
    day: "8/10/2022",
    age: ">25",
    gender: "Female",
    A: 56,
    B: 687,
    C: 383,
    D: 553,
    E: 933,
    F: 739,
  },
  {
    day: "9/10/2022",
    age: "15-25",
    gender: "Male",
    A: 655,
    B: 415,
    C: 249,
    D: 603,
    E: 792,
    F: 312,
  },
  {
    day: "9/10/2022",
    age: ">25",
    gender: "Male",
    A: 828,
    B: 697,
    C: 943,
    D: 697,
    E: 81,
    F: 713,
  },
  {
    day: "9/10/2022",
    age: "15-25",
    gender: "Female",
    A: 103,
    B: 612,
    C: 442,
    D: 907,
    E: 100,
    F: 727,
  },
  {
    day: "9/10/2022",
    age: ">25",
    gender: "Female",
    A: 342,
    B: 734,
    C: 725,
    D: 98,
    E: 89,
    F: 822,
  },
  {
    day: "10/10/2022",
    age: "15-25",
    gender: "Male",
    A: 612,
    B: 828,
    C: 469,
    D: 725,
    E: 780,
    F: 314,
  },
  {
    day: "10/10/2022",
    age: ">25",
    gender: "Male",
    A: 937,
    B: 285,
    C: 326,
    D: 13,
    E: 420,
    F: 22,
  },
  {
    day: "10/10/2022",
    age: "15-25",
    gender: "Female",
    A: 294,
    B: 670,
    C: 151,
    D: 796,
    E: 538,
    F: 775,
  },
  {
    day: "10/10/2022",
    age: ">25",
    gender: "Female",
    A: 368,
    B: 926,
    C: 125,
    D: 882,
    E: 922,
    F: 193,
  },
  {
    day: "11/10/2022",
    age: "15-25",
    gender: "Male",
    A: 500,
    B: 327,
    C: 628,
    D: 19,
    E: 794,
    F: 764,
  },
  {
    day: "11/10/2022",
    age: ">25",
    gender: "Male",
    A: 768,
    B: 880,
    C: 517,
    D: 510,
    E: 644,
    F: 915,
  },
  {
    day: "11/10/2022",
    age: "15-25",
    gender: "Female",
    A: 651,
    B: 695,
    C: 200,
    D: 891,
    E: 285,
    F: 338,
  },
  {
    day: "11/10/2022",
    age: ">25",
    gender: "Female",
    A: 496,
    B: 824,
    C: 867,
    D: 515,
    E: 691,
    F: 674,
  },
  {
    day: "12/10/2022",
    age: "15-25",
    gender: "Male",
    A: 248,
    B: 356,
    C: 329,
    D: 526,
    E: 712,
    F: 934,
  },
  {
    day: "12/10/2022",
    age: ">25",
    gender: "Male",
    A: 531,
    B: 744,
    C: 527,
    D: 794,
    E: 739,
    F: 32,
  },
  {
    day: "12/10/2022",
    age: "15-25",
    gender: "Female",
    A: 908,
    B: 688,
    C: 930,
    D: 874,
    E: 20,
    F: 148,
  },
  {
    day: "12/10/2022",
    age: ">25",
    gender: "Female",
    A: 988,
    B: 118,
    C: 276,
    D: 431,
    E: 222,
    F: 443,
  },
  {
    day: "13/10/2022",
    age: "15-25",
    gender: "Male",
    A: 906,
    B: 946,
    C: 840,
    D: 719,
    E: 475,
    F: 874,
  },
  {
    day: "13/10/2022",
    age: ">25",
    gender: "Male",
    A: 745,
    B: 326,
    C: 723,
    D: 561,
    E: 545,
    F: 334,
  },
  {
    day: "13/10/2022",
    age: "15-25",
    gender: "Female",
    A: 314,
    B: 810,
    C: 496,
    D: 251,
    E: 270,
    F: 809,
  },
  {
    day: "13/10/2022",
    age: ">25",
    gender: "Female",
    A: 638,
    B: 707,
    C: 409,
    D: 80,
    E: 806,
    F: 568,
  },
  {
    day: "14/10/2022",
    age: "15-25",
    gender: "Male",
    A: 195,
    B: 109,
    C: 581,
    D: 914,
    E: 299,
    F: 897,
  },
  {
    day: "14/10/2022",
    age: ">25",
    gender: "Male",
    A: 666,
    B: 647,
    C: 47,
    D: 414,
    E: 306,
    F: 404,
  },
  {
    day: "14/10/2022",
    age: "15-25",
    gender: "Female",
    A: 560,
    B: 737,
    C: 764,
    D: 576,
    E: 952,
    F: 351,
  },
  {
    day: "14/10/2022",
    age: ">25",
    gender: "Female",
    A: 33,
    B: 300,
    C: 506,
    D: 756,
    E: 386,
    F: 591,
  },
  {
    day: "15/10/2022",
    age: "15-25",
    gender: "Male",
    A: 88,
    B: 18,
    C: 18,
    D: 809,
    E: 114,
    F: 997,
  },
  {
    day: "15/10/2022",
    age: ">25",
    gender: "Male",
    A: 643,
    B: 230,
    C: 63,
    D: 655,
    E: 507,
    F: 752,
  },
  {
    day: "15/10/2022",
    age: "15-25",
    gender: "Female",
    A: 953,
    B: 456,
    C: 491,
    D: 755,
    E: 967,
    F: 243,
  },
  {
    day: "15/10/2022",
    age: ">25",
    gender: "Female",
    A: 853,
    B: 429,
    C: 153,
    D: 604,
    E: 911,
    F: 927,
  },
  {
    day: "16/10/2022",
    age: "15-25",
    gender: "Male",
    A: 41,
    B: 95,
    C: 209,
    D: 154,
    E: 614,
    F: 579,
  },
  {
    day: "16/10/2022",
    age: ">25",
    gender: "Male",
    A: 762,
    B: 663,
    C: 199,
    D: 414,
    E: 935,
    F: 244,
  },
  {
    day: "16/10/2022",
    age: "15-25",
    gender: "Female",
    A: 416,
    B: 86,
    C: 69,
    D: 970,
    E: 294,
    F: 803,
  },
  {
    day: "16/10/2022",
    age: ">25",
    gender: "Female",
    A: 927,
    B: 35,
    C: 442,
    D: 904,
    E: 261,
    F: 518,
  },
  {
    day: "17/10/2022",
    age: "15-25",
    gender: "Male",
    A: 863,
    B: 52,
    C: 740,
    D: 624,
    E: 905,
    F: 70,
  },
  {
    day: "17/10/2022",
    age: ">25",
    gender: "Male",
    A: 887,
    B: 641,
    C: 502,
    D: 408,
    E: 895,
    F: 868,
  },
  {
    day: "17/10/2022",
    age: "15-25",
    gender: "Female",
    A: 803,
    B: 846,
    C: 136,
    D: 403,
    E: 209,
    F: 756,
  },
  {
    day: "17/10/2022",
    age: ">25",
    gender: "Female",
    A: 249,
    B: 392,
    C: 36,
    D: 280,
    E: 883,
    F: 886,
  },
  {
    day: "18/10/2022",
    age: "15-25",
    gender: "Male",
    A: 972,
    B: 282,
    C: 686,
    D: 373,
    E: 762,
    F: 544,
  },
  {
    day: "18/10/2022",
    age: ">25",
    gender: "Male",
    A: 632,
    B: 880,
    C: 676,
    D: 207,
    E: 176,
    F: 741,
  },
  {
    day: "18/10/2022",
    age: "15-25",
    gender: "Female",
    A: 884,
    B: 657,
    C: 363,
    D: 449,
    E: 371,
    F: 352,
  },
  {
    day: "18/10/2022",
    age: ">25",
    gender: "Female",
    A: 698,
    B: 725,
    C: 769,
    D: 360,
    E: 80,
    F: 667,
  },
  {
    day: "19/10/2022",
    age: "15-25",
    gender: "Male",
    A: 981,
    B: 694,
    C: 534,
    D: 682,
    E: 948,
    F: 474,
  },
  {
    day: "19/10/2022",
    age: ">25",
    gender: "Male",
    A: 834,
    B: 334,
    C: 409,
    D: 147,
    E: 669,
    F: 677,
  },
  {
    day: "19/10/2022",
    age: "15-25",
    gender: "Female",
    A: 135,
    B: 243,
    C: 589,
    D: 573,
    E: 528,
    F: 983,
  },
  {
    day: "19/10/2022",
    age: ">25",
    gender: "Female",
    A: 20,
    B: 758,
    C: 291,
    D: 299,
    E: 977,
    F: 811,
  },
  {
    day: "20/10/2022",
    age: "15-25",
    gender: "Male",
    A: 114,
    B: 289,
    C: 707,
    D: 305,
    E: 838,
    F: 172,
  },
  {
    day: "20/10/2022",
    age: ">25",
    gender: "Male",
    A: 814,
    B: 992,
    C: 820,
    D: 920,
    E: 475,
    F: 608,
  },
  {
    day: "20/10/2022",
    age: "15-25",
    gender: "Female",
    A: 66,
    B: 744,
    C: 264,
    D: 300,
    E: 486,
    F: 740,
  },
  {
    day: "20/10/2022",
    age: ">25",
    gender: "Female",
    A: 535,
    B: 389,
    C: 311,
    D: 727,
    E: 287,
    F: 814,
  },
  {
    day: "21/10/2022",
    age: "15-25",
    gender: "Male",
    A: 974,
    B: 273,
    C: 455,
    D: 881,
    E: 899,
    F: 202,
  },
  {
    day: "21/10/2022",
    age: ">25",
    gender: "Male",
    A: 107,
    B: 924,
    C: 328,
    D: 430,
    E: 38,
    F: 865,
  },
  {
    day: "21/10/2022",
    age: "15-25",
    gender: "Female",
    A: 452,
    B: 61,
    C: 859,
    D: 106,
    E: 817,
    F: 748,
  },
  {
    day: "21/10/2022",
    age: ">25",
    gender: "Female",
    A: 96,
    B: 811,
    C: 210,
    D: 917,
    E: 385,
    F: 781,
  },
  {
    day: "22/10/2022",
    age: "15-25",
    gender: "Male",
    A: 526,
    B: 490,
    C: 377,
    D: 765,
    E: 145,
    F: 330,
  },
  {
    day: "22/10/2022",
    age: ">25",
    gender: "Male",
    A: 349,
    B: 356,
    C: 465,
    D: 742,
    E: 18,
    F: 689,
  },
  {
    day: "22/10/2022",
    age: "15-25",
    gender: "Female",
    A: 274,
    B: 136,
    C: 492,
    D: 93,
    E: 495,
    F: 354,
  },
  {
    day: "22/10/2022",
    age: ">25",
    gender: "Female",
    A: 73,
    B: 719,
    C: 124,
    D: 411,
    E: 633,
    F: 625,
  },
  {
    day: "23/10/2022",
    age: "15-25",
    gender: "Male",
    A: 58,
    B: 319,
    C: 796,
    D: 228,
    E: 807,
    F: 144,
  },
  {
    day: "23/10/2022",
    age: ">25",
    gender: "Male",
    A: 686,
    B: 302,
    C: 877,
    D: 780,
    E: 634,
    F: 280,
  },
  {
    day: "23/10/2022",
    age: "15-25",
    gender: "Female",
    A: 556,
    B: 321,
    C: 534,
    D: 456,
    E: 295,
    F: 477,
  },
  {
    day: "23/10/2022",
    age: ">25",
    gender: "Female",
    A: 518,
    B: 684,
    C: 134,
    D: 895,
    E: 558,
    F: 450,
  },
  {
    day: "24/10/2022",
    age: "15-25",
    gender: "Male",
    A: 962,
    B: 948,
    C: 512,
    D: 772,
    E: 857,
    F: 520,
  },
  {
    day: "24/10/2022",
    age: ">25",
    gender: "Male",
    A: 454,
    B: 652,
    C: 300,
    D: 6,
    E: 758,
    F: 404,
  },
  {
    day: "24/10/2022",
    age: "15-25",
    gender: "Female",
    A: 578,
    B: 875,
    C: 357,
    D: 671,
    E: 304,
    F: 520,
  },
  {
    day: "24/10/2022",
    age: ">25",
    gender: "Female",
    A: 200,
    B: 374,
    C: 861,
    D: 854,
    E: 300,
    F: 980,
  },
  {
    day: "25/10/2022",
    age: "15-25",
    gender: "Male",
    A: 897,
    B: 92,
    C: 219,
    D: 667,
    E: 949,
    F: 523,
  },
  {
    day: "25/10/2022",
    age: ">25",
    gender: "Male",
    A: 824,
    B: 742,
    C: 379,
    D: 465,
    E: 293,
    F: 848,
  },
  {
    day: "25/10/2022",
    age: "15-25",
    gender: "Female",
    A: 138,
    B: 326,
    C: 714,
    D: 254,
    E: 357,
    F: 225,
  },
  {
    day: "25/10/2022",
    age: ">25",
    gender: "Female",
    A: 931,
    B: 71,
    C: 573,
    D: 447,
    E: 641,
    F: 923,
  },
  {
    day: "26/10/2022",
    age: "15-25",
    gender: "Male",
    A: 882,
    B: 868,
    C: 998,
    D: 520,
    E: 542,
    F: 180,
  },
  {
    day: "26/10/2022",
    age: ">25",
    gender: "Male",
    A: 788,
    B: 65,
    C: 974,
    D: 432,
    E: 292,
    F: 4,
  },
  {
    day: "26/10/2022",
    age: "15-25",
    gender: "Female",
    A: 635,
    B: 141,
    C: 468,
    D: 700,
    E: 541,
    F: 802,
  },
  {
    day: "26/10/2022",
    age: ">25",
    gender: "Female",
    A: 404,
    B: 847,
    C: 931,
    D: 40,
    E: 86,
    F: 365,
  },
  {
    day: "27/10/2022",
    age: "15-25",
    gender: "Male",
    A: 260,
    B: 431,
    C: 872,
    D: 777,
    E: 721,
    F: 789,
  },
  {
    day: "27/10/2022",
    age: ">25",
    gender: "Male",
    A: 168,
    B: 230,
    C: 56,
    D: 395,
    E: 786,
    F: 475,
  },
  {
    day: "27/10/2022",
    age: "15-25",
    gender: "Female",
    A: 726,
    B: 693,
    C: 494,
    D: 912,
    E: 183,
    F: 439,
  },
  {
    day: "27/10/2022",
    age: ">25",
    gender: "Female",
    A: 850,
    B: 849,
    C: 594,
    D: 86,
    E: 711,
    F: 534,
  },
  {
    day: "28/10/2022",
    age: "15-25",
    gender: "Male",
    A: 363,
    B: 485,
    C: 355,
    D: 592,
    E: 239,
    F: 68,
  },
  {
    day: "28/10/2022",
    age: ">25",
    gender: "Male",
    A: 292,
    B: 238,
    C: 384,
    D: 260,
    E: 579,
    F: 854,
  },
  {
    day: "28/10/2022",
    age: "15-25",
    gender: "Female",
    A: 284,
    B: 1000,
    C: 654,
    D: 36,
    E: 881,
    F: 60,
  },
  {
    day: "28/10/2022",
    age: ">25",
    gender: "Female",
    A: 921,
    B: 364,
    C: 225,
    D: 346,
    E: 897,
    F: 842,
  },
  {
    day: "29/10/2022",
    age: "15-25",
    gender: "Male",
    A: 910,
    B: 475,
    C: 278,
    D: 432,
    E: 874,
    F: 531,
  },
  {
    day: "29/10/2022",
    age: ">25",
    gender: "Male",
    A: 611,
    B: 887,
    C: 852,
    D: 474,
    E: 59,
    F: 810,
  },
  {
    day: "29/10/2022",
    age: "15-25",
    gender: "Female",
    A: 108,
    B: 70,
    C: 633,
    D: 118,
    E: 217,
    F: 808,
  },
  {
    day: "29/10/2022",
    age: ">25",
    gender: "Female",
    A: 577,
    B: 723,
    C: 890,
    D: 18,
    E: 673,
    F: 691,
  },
];

const seedDb = async () => {
  await Data.deleteMany({}); //database keyword to delete many items/data if any exists.
  await Data.insertMany(seedItems); //this insert's the defined data above
};

seedDb()
  .then(() => {
    console.log(`items added`);
    mongoose.connection.close(); //after adding the data connection to the db is closed
  })
  .catch((error) => {
    console.log(error);
  });

app.get("/api/data", async (req, res) => {
  try {
    const data = await Data.find();

    if (!data) {
      return res.status(404).json({ message: "No data found" });
    }

    res.status(200).json(data);
  } catch (error) {
    console.log(error);
    res.status(500).json({ error: error });
  }
});

const PORT = 3000;
app.listen(PORT, () => {
  console.log(`Server connected to port http://localhost:${PORT}`);
});
